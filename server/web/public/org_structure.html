<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Organization Structure Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-50">
  <header class="bg-white border-b py-4">
    <div class="max-w-6xl mx-auto px-6 flex justify-between items-center">
      <div>
        <h1 class="text-xl font-semibold">Organization Structure Management</h1>
        <p class="text-sm text-gray-500">Manage departments and organizational hierarchy</p>
      </div>
      <div>
        <button id="logoutBtn" class="text-sm text-gray-700">Logout</button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-6 py-8">
    <div class="mb-4">
      <nav class="flex gap-6 border-b" role="tablist" aria-label="Organization tabs">
        <button class="tab active py-3 px-2 text-blue-600 border-b-2 border-blue-600" data-tab="list" role="tab" aria-selected="true">Departments</button>
        <button class="tab py-3 px-2 text-gray-600" data-tab="assign" role="tab" aria-selected="false">Assign Department Heads</button>
        <button class="tab py-3 px-2 text-gray-600" data-tab="reassign" role="tab" aria-selected="false">Reassign Employees</button>
      </nav>
    </div>

    <!-- Departments tab -->
    <section id="tab-list" class="tab-content" role="tabpanel">
      <div class="mb-4 flex items-center gap-4">
        <button id="openCreateDeptBtn" class="bg-blue-600 text-white px-4 py-2 rounded">+ Create Department</button>
        <input id="deptSearch" placeholder="Search departments..." class="border rounded px-3 py-2 w-64 text-sm" aria-label="Search departments" />
      </div>

      <div id="departmentsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-6" aria-live="polite"></div>
    </section>

    <!-- Assign head -->
    <section id="tab-assign" class="tab-content hidden" role="tabpanel" aria-hidden="true">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="font-semibold mb-4">Assign Department Heads</h2>
        <div class="space-y-3">
          <label class="sr-only" for="assign_dept">Department</label>
          <select id="assign_dept" class="w-full border rounded px-3 py-2" aria-label="Select department to assign head"><option value="">Select department...</option></select>

          <label class="sr-only" for="assign_emp">Employee</label>
          <select id="assign_emp" class="w-full border rounded px-3 py-2" aria-label="Select employee to be head"><option value="">Select employee...</option></select>

          <div class="flex items-center gap-3">
            <button id="assignHeadBtn" class="bg-blue-600 text-white px-4 py-2 rounded">Assign Head</button>
            <p id="assignMsg" class="text-sm" aria-live="polite"></p>
          </div>
        </div>
      </div>
    </section>

    <!-- Reassign employee (FROM removed) -->
    <section id="tab-reassign" class="tab-content hidden" role="tabpanel" aria-hidden="true">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="font-semibold mb-4">Reassign Employee Between Departments</h2>
        <div class="space-y-3">
          <label class="sr-only" for="reassign_emp">Employee</label>
          <select id="reassign_emp" class="w-full border rounded px-3 py-2" aria-label="Select employee to reassign"><option value="">Select employee...</option></select>

          <!-- from_dept removed -->

          <label class="sr-only" for="to_dept">To Department</label>
          <select id="to_dept" class="w-full border rounded px-3 py-2" aria-label="To department"><option value="">Select department...</option></select>

          <div class="flex items-center gap-3">
            <button id="reassignBtn" class="bg-blue-600 text-white px-4 py-2 rounded">Reassign Employee</button>
            <p id="reassignMsg" class="text-sm" aria-live="polite"></p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Create / Edit Department Modal -->
  <div id="deptModal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black/40" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="bg-white rounded-lg w-full max-w-lg p-6 shadow-lg" role="document">
      <div class="flex justify-between items-center mb-4">
        <h3 id="deptModalTitle" class="text-lg font-semibold">Create Department</h3>
        <button id="closeDeptModal" class="text-gray-500 hover:text-gray-800" aria-label="Close modal">âœ•</button>
      </div>

      <form id="deptForm" class="space-y-4" novalidate>
        <input type="hidden" id="dept_id" value="" />
        <div>
          <label for="dept_name" class="block text-sm font-medium text-gray-700">Department name</label>
          <input id="dept_name" required class="w-full border rounded px-3 py-2" />
        </div>

        <div>
          <label for="dept_location" class="block text-sm font-medium text-gray-700">Location (optional)</label>
          <input id="dept_location" class="w-full border rounded px-3 py-2" />
        </div>

        <div class="flex gap-2">
          <button id="saveDeptBtn" type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Save</button>
          <button id="cancelDeptBtn" type="button" class="bg-gray-200 px-4 py-2 rounded">Cancel</button>
          <button id="deleteDeptBtn" type="button" class="ml-auto text-red-600 hidden">Delete</button>
        </div>
        <p id="deptMsg" class="text-sm" aria-live="polite"></p>
      </form>
    </div>
  </div>

  <script src="/js/org_structure.js"></script>
</body>
</html>
